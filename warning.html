<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Confidentiality Warning</title>
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js" type="text/javascript"></script>
    <style>
        body { font-family: "Segoe UI", sans-serif; background-color: #FFF4CE; text-align: center; padding: 20px; color: #333; }
        h1 { color: #C00000; font-size: 20px; margin-top: 0; }
        p { font-size: 14px; margin-bottom: 20px; }
        
        /* Box to show the list of emails */
        .email-list { 
            background: white; border: 1px solid #ccc; border-radius: 4px; 
            padding: 10px; max-height: 100px; overflow-y: auto; text-align: left;
            font-size: 13px; color: #d13438; font-weight: bold; margin-bottom: 20px;
        }
        ul { margin: 0; padding-left: 20px; }
        
        /* Stack buttons */
        .btn-group { display: flex; flex-direction: column; gap: 10px; }
        .btn { padding: 12px 15px; font-size: 14px; border: none; border-radius: 4px; cursor: pointer; width: 100%; font-weight: bold; }
        
        .btn-send { background-color: #C00000; color: white; }
        .btn-cancel { background-color: #E1DFDD; color: black; }
        .btn:hover { opacity: 0.9; }
    </style>
</head>
<body>
    <h1>⚠️ Confidentiality Warning</h1>
    
    <p id="dynamicText">You are sending this email to * recipient outside:</p>
    
    <div class="email-list">
        <ul id="extList">
            </ul>
    </div>
    
    <p>Are you sure you want to send this email?</p>

    <div class="btn-group">
        <button id="sendBtn" class="btn btn-send">Yes, Send Anyway</button>
        <button id="cancelBtn" class="btn btn-cancel">No, Cancel</button>
    </div>

    <script>
        Office.onReady(function() {
            // Get emails from the URL
            var urlParams = new URLSearchParams(window.location.search);
            var extString = urlParams.get('ext');
            
            // List the emails in the box and update the text
            if (extString) {
                var emails = extString.split(',');
                var listHtml = "";
                for (var i = 0; i < emails.length; i++) {
                    listHtml += "<li>" + emails[i] + "</li>";
                }
                document.getElementById("extList").innerHTML = listHtml;
                
                // Dynamically replace the "*" with the actual number of recipients
                var recWord = emails.length === 1 ? "recipient" : "recipients";
                document.getElementById("dynamicText").innerText = "You are sending this email to " + emails.length + " " + recWord + " outside:";
                
            } else {
                document.getElementById("extList").innerHTML = "<li>External recipients found</li>";
                document.getElementById("dynamicText").innerText = "You are sending this email to recipients outside:";
            }

            // Button Logic: Allow or Cancel
            document.getElementById("sendBtn").onclick = function() { Office.context.ui.messageParent("allow"); };
            document.getElementById("cancelBtn").onclick = function() { Office.context.ui.messageParent("cancel"); };
        });
    </script>
</body>
</html>
