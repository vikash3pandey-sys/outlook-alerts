<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Confidentiality Warning</title>
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js" type="text/javascript"></script>
    <style>
        body { 
            font-family: "Segoe UI", sans-serif; 
            background-color: #FFFFFF; 
            color: #333333; 
            text-align: center; 
            padding: 20px; 
            margin: 0;
        }
        h1 { 
            font-size: 18px; 
            color: #D13438; /* Subtle Red */
            margin-top: 0; 
            padding-bottom: 10px;
            border-bottom: 1px solid #E1DFDD;
        }
        p { font-size: 14px; margin-bottom: 15px; }
        
        .email-list { 
            background: #F3F2F1; 
            border: 1px solid #E1DFDD; 
            border-radius: 4px;
            padding: 10px; 
            max-height: 90px; 
            overflow-y: auto; 
            text-align: left;
            font-size: 13px; 
            color: #D13438;
            font-weight: 600; 
            margin-bottom: 20px;
        }
        ul { margin: 0; padding-left: 20px; }
        
        .btn-group { display: flex; flex-direction: column; gap: 10px; }
        .btn { 
            padding: 10px 15px; 
            font-size: 14px; 
            border-radius: 4px;
            cursor: pointer; 
            width: 100%; 
            font-weight: bold; 
            border: none;
        }
        
        .btn-cancel { background-color: #0078D4; color: white; } /* Blue primary button */
        .btn-send { background-color: #FFFFFF; color: #333333; border: 1px solid #8A8886; } /* Outlined secondary */
        
        .btn:hover { opacity: 0.8; }
    </style>
</head>
<body>
    <h1>Confidentiality Warning</h1>
    
    <p id="dynamicText">You are sending this email to external recipients:</p>
    
    <div class="email-list">
        <ul id="extList"></ul>
    </div>
    
    <p>Are you sure you want to send this email?</p>

    <div class="btn-group">
        <button id="cancelBtn" class="btn btn-cancel">No, Cancel Send</button>
        <button id="sendBtn" class="btn btn-send">Yes, Send Anyway</button>
    </div>

    <script>
        Office.onReady(function() {
            var urlParams = new URLSearchParams(window.location.search);
            var extString = urlParams.get('ext');
            
            if (extString) {
                var emails = extString.split(',');
                var listHtml = "";
                for (var i = 0; i < emails.length; i++) {
                    listHtml += "<li>" + emails[i] + "</li>";
                }
                document.getElementById("extList").innerHTML = listHtml;
                
                var recWord = emails.length === 1 ? "recipient" : "recipients";
                document.getElementById("dynamicText").innerText = "You are sending this email to " + emails.length + " " + recWord + " outside:";
            }

            // Send messages back to the background script
            document.getElementById("sendBtn").onclick = function() { Office.context.ui.messageParent("allow"); };
            document.getElementById("cancelBtn").onclick = function() { Office.context.ui.messageParent("cancel"); };
        });
    </script>
</body>
</html>
